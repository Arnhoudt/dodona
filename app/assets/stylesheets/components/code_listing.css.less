@dot-size: 9px;

.code-table {

  .code-listing {

    padding-top: 5px;
    padding-bottom: 5px;

    user-select: none;
    display: block;
    overflow-x: auto;
    white-space: nowrap;

    background-color: @well-bg;

    // Override the normal pre padding & coloring
    pre {
      padding: 0;
      background-color: transparent;
      margin-bottom: 0;
      border: none;
      border-radius: 0;
      white-space: pre-wrap;
    }

    .lineno.marked {
      background-color: @warning-500;
    }

    .lineno .annotation-button {
      margin: -3px -10px -3px -18px;
      padding: 2px;
      border: 0;
      display: none;
      float: left;

      background-color: @btn-hover-background;
      border-radius: 3px;

      position: relative;
      cursor: pointer;
      text-align: center;
      text-indent: 0;
    }

    .lineno .annotation-button:hover {
      transform: scale(1.15);
      transition: 0.1s ease-in-out;
    }

    .lineno:hover .annotation-button {
      display: block;
    }

    .rouge-code {
      width: 100%;
      padding-left: 5px;
      user-select: text;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .rouge-gutter {
      vertical-align: top;
      white-space: nowrap;
      text-align: right;
      padding-right: 5px;

      display: flex;
      justify-content: flex-end;

      background-color: @well-bg;

      pre {
        padding-right: 5px;
        margin-left: 20px;
        white-space: nowrap;
        font-family: @font-family-monospace;
        color: @gray-light
      }

      .dot {
        float: left;
        margin-left: 4px;
        margin-top: 4px;
        height: @dot-size;
        width: @dot-size;
        border-radius: 100%;
      }

      .dot-info {
        background-color: @info-500;
      }

      .dot-warning {
        background-color: @warning-500;
      }

      .dot-error {
        background-color: @danger-500;
      }
    }

    .rouge-code, .annotation-cell, .message-cell {
      background-color: @body-bg;
    }

    .hide {
      display: none;
    }

    .message-set {
      .message-cell {

        width: 100%;

        .message {
          font-family: @font-family-monospace;
          margin: 3px 5px 3px 10px;
          padding: 2px 10px;
          border-radius: 0 5px 5px 0;
          border: 1px solid @hairlinegray;
          border-left-width: 3px;
          background: @content-bg;
          white-space: pre-wrap;
        }

        .message.error {
          border-left-color: @danger-500;
        }

        .message.warning {
          border-left-color: @warning-500;
        }

        .message.info {
          border-left-color: @info-500;
        }

        div.copy-blocker {
          position: absolute;
          user-select: text;
          height: 100%;
        }

        .annotation-submission {
          margin: 4px 10px;
        }
      }
    }

    .annotation {
      max-width: 100%;
      border-top-right-radius: 5px;
      border-bottom-right-radius: 5px;
      border: 1px solid @hairlinegray;
      border-left-width: 3px;
      border-left-color: @success-300;
      padding: 5px 3px;
      background: @content-bg;
      margin: 4px 10px;

      white-space: normal;

      .annotation-header {
        display: flex;
        flex-wrap: nowrap;
        flex-direction: row;

        .annotation-user {
          margin-left: 6px;
          flex-grow: 1;
          font-weight: bold;
        }

        .annotation-control-button {
          margin: 3px;
        }
      }

      .annotation-text {
        display: block;
        word-break: break-word;

        margin-left: 6px;
        margin-right: 6px;

        // Stylize the embedded code block
        .highlighter-rouge div.highlight {
          padding: 5px;
          margin-left: 10px;
          margin-right: 10px;
          background: @code-bg;
          border-radius: 3px;
        }

        .highlighter-rouge {
          margin-top: 8px;
          margin-bottom: 8px;
        }

        hr {
          margin-top: 8px;
          margin-bottom: 8px;
        }

        img {
          display: block;
          margin: 10px auto 20px;

          max-width: 300px;
          @media (min-width: @screen-tablet) {
            max-width: calc(@container-tablet * 0.6);
          }
          @media (min-width: @screen-lg) {
            max-width: calc(@container-desktop * 0.7);
          }
          @media (min-width: @screen-lg-desktop) {
            max-width: calc(@container-large-desktop * 0.7);
          }
        }
      }
    }

    .annotation-submission {

      .annotation-submission-button-container {
        display: flex;
        flex-wrap: nowrap;
        flex-direction: row-reverse;

        .annotation-control-button {
          margin: 3px;
          cursor: pointer;
        }

        .annotation-submission-error-list {
          margin-top: 3px;
          margin-bottom: 3px;
          flex-grow: 1;
        }
      }

      #submission-textarea {
        flex-grow: 1;
        border-radius: 0;
        resize: vertical;
        min-height: 46px;
      }

      padding: 5px;
    }

    .annotation-control-button.disabled {
      cursor: not-allowed !important;
      opacity: 0.65;
      color: red;
    }
  }
}
